# Limpar
rm(list=ls())
#Diretório
setwd("C:/Users/Caio Azevedo/Documents/Documentos Caio/Github/Series-Temporais/Figuras")
# Carregando pacotes a serem utilizados
library(forecast)
library(dplyr)
library(lattice)
# Exportando os dados disponíveis no GitHub
site <- "https://raw.githubusercontent.com/caio-azevedo/Series-Temporais/master/data/PIB.csv"
dados<- read.table(site, header=T, sep=";", dec = ",",
col.names = c("ano", "mes", "pib"))
# Configurando os dados para o formato de séries temporais
attach(dados)
pib90 <-ts(pib, start=c(1990,1), frequency = 12)
plot(pib90)
dev.copy(pdf,"pib90.pdf")
dev.off()
# Fazendo um recorte de tempo nos dados a partir de 2000
pib2010<- window(pib90, start=2010)
# Plotando o gráfico da série
plot(pib2010)
dev.copy(pdf,"pib2010.pdf")
dev.off()
# Aplicando a Suavização de Holt - Winters erros aditivos
pib_hw<-hw(pib2010, level = 95, h=10, seasonal = "additive")
plot(pib_hw)
# Gerar uma nova série através da Suavização Exponencial Simples (SES)
pib_prev<- pib_hw[["model"]][["fitted"]]
pib_prev<-data.frame(pib_prev)
#Retirando os valores previstos da SES para fora da amostra
x<-data.frame(pib_hw, row.names = c(1:10))
x<-x %>%
select("Point.Forecast") %>%
rename("pib_prev"="Point.Forecast")
pib_prev<-bind_rows(pib_prev, x)
# Juntar as duas séries - original e suavizada - em uma matriz para formar um gráfico único
pib2010<-data.frame(pib2010)
# é necessário criar um vetor nulo pra completar a série original
# a repetição é de acordo com o número de períodos a ser previsto
nulo<-c(rep(NA,10))
nulo<-data.frame(nulo)
nulo<-nulo %>%
rename("pib2010"="nulo")
pib2010<-bind_rows(pib2010, nulo)
graf<-cbind(pib2010, pib_prev)
colnames(graf)<-c("Série Original", "HW")
# Retornando para o formato temporal
graf_ts<-ts(graf, start=c(2010,1), frequency = 12)
# Plotar um único gráfico
xyplot(graf_ts, superpose = TRUE, lwd = 2)
dev.copy(pdf,"pib.pdf")
dev.off()
View(pib_prev)
View(pib_prev)
View(pib_hw)
View(graf)
pib_hw[["model"]][["fitted"]]
pib_hw
print(xtable(pib_hw, caption = "Previsão para o PIB através do Modelo de HW",
label = "tab3"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
View(pib_hw)
pib_hw
hw<-data.frame(pib_hw)
View(hw)
print(xtable(hw, caption = "Previsão para o PIB através do Modelo de HW",
label = "tab3"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
library(xtable)
print(xtable(hw, caption = "Previsão para o PIB através do Modelo de HW",
label = "tab3"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(pib_hw, caption = "Previsão para o PIB através do Modelo de HW",
label = "tab3"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
View(pib_hw)
modelo <- ets(pib2010, "AAA")
# Limpar----
rm(list=ls())
#Diretório
setwd("C:/Users/Caio Azevedo/Documents/Documentos Caio/Github/Series-Temporais/Figuras")
# Carregando pacotes a serem utilizados
library(forecast)
library(dplyr)
library(lattice)
library(xtable)
# Exportando os dados disponíveis no GitHub
site <- "https://raw.githubusercontent.com/caio-azevedo/Series-Temporais/master/data/PIB.csv"
dados<- read.table(site, header=T, sep=";", dec = ",",
col.names = c("ano", "mes", "pib"))
# Configurando os dados para o formato de séries temporais
attach(dados)
pib90 <-ts(pib, start=c(1990,1), frequency = 12)
plot(pib90)
dev.copy(pdf,"pib90.pdf")
dev.off()
# Fazendo um recorte de tempo nos dados a partir de 2000
pib2010<- window(pib90, start=2010)
# Plotando o gráfico da série
plot(pib2010)
dev.copy(pdf,"pib2010.pdf")
dev.off()
# Aplicando a Suavização de Holt - Winters erros aditivos----
pib_hw<-hw(pib2010, level = 95, h=10, seasonal = "additive")
plot(pib_hw)
#Encontrar os parâmetros estimados
modelo <- ets(pib2010, "AAA")
modelo
library(stargazer)
stargazer(modelo)
print(xtable(modelo))
View(modelo)
modelo[["fitted"]]
modelo <- ets(pib2010, "AAA", h=10)
modelo <- ets(pib2010, "AAA")
View(modelo)
pib_prev<- pib_hw[["model"]][["fitted"]]
pib_prev<-data.frame(pib_prev)
View(pib_prev)
View(pib_hw)
View(modelo)
loglik <- pib_hw[["model"]][["loglik"]]
aic <- pib_hw[["model"]][["aic]]
bic <- pib_hw[["model"]][["bic"]]
aicc <- pib_hw[["model"]][["aicc"]]
mse <- pib_hw[["model"]][["mse"]]
amse <- pib_hw[["model"]][["amse"]]
sigma<-sqrt(pib_hw[["model"]][["sigma2"]])
alpha<-pib_hw[["model"]][["par"]][["alpha"]]
beta<-pib_hw[["model"]][["par"]][["beta"]]
gamma<-pib_hw[["model"]][["par"]][["gamma"]]
sigma<-sqrt(pib_hw[["model"]][["sigma2"]])
paramentos<-data.frame(c(alpha, beta, gamma, sigma))
View(paramentos)
parametros<-data.frame(c(alpha, beta, gamma, sigma), colnames("Parâmetros estimados"))
colnames(parametros)<-c("Parâmetros estimados")
parametros<-data.frame(c(alpha, beta, gamma, sigma))
colnames(parametros)<-c("Parâmetros estimados")
View(parametros)
parametros<-data.frame(c(alpha, beta, gamma, sigma), round(2))
colnames(parametros)<-c("Parâmetros estimados")
View(parametros)
parametros<-data.frame(c(alpha, beta, gamma, sigma), round=4)
colnames(parametros)<-c("Parâmetros estimados")
View(parametros)
rownames(parametros)<-c("alpha", "beta", "gamma", "sigma")
View(parametros)
parametros<-data.frame(c(alpha, beta, gamma, sigma))
colnames(parametros)<-c("Parâmetros estimados")
rownames(parametros)<-c("alpha", "beta", "gamma", "sigma")
View(parametros)
pib_hw[["model"]][["sigma2"]]
help(xtable)
print(xtable(parametros, caption = "Parâmetros estimados pelo Modelo HW",
label = "tab1"),
caption.placement = "top",
include.rownames = TRUE,
digits = 4,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(parametros, caption = "Parâmetros estimados pelo Modelo HW",
label = "tab1"),
caption.placement = "top",
include.rownames = TRUE,
digits = 6,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(parametros, caption = "Parâmetros estimados pelo Modelo HW",
label = "tab1"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
View(paramentos)
parametros<-data.frame(c(alpha, beta, gamma, sigma), digits=6)
View(parametros)
digits(parametros, 6)
alpha<-round(pib_hw[["model"]][["par"]][["alpha"]], digits = 4)
alpha<-round(pib_hw[["model"]][["par"]][["alpha"]], digits = 4)
beta<-round(pib_hw[["model"]][["par"]][["beta"]], digits = 4)
gamma<-round(pib_hw[["model"]][["par"]][["gamma"]], digits = 4)
sigma<-round(sqrt(pib_hw[["model"]][["sigma2"]]), digits = 4)
parametros<-data.frame(c(alpha, beta, gamma, sigma))
colnames(parametros)<-c("Parâmetros estimados")
rownames(parametros)<-c("alpha", "beta", "gamma", "sigma")
View(parametros)
print(xtable(parametros, caption = "Parâmetros estimados pelo Modelo HW",
label = "tab1"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(parametros, caption = "Parâmetros estimados pelo Modelo HW",
label = "tab1", digits = 4),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
l<-round(pib_hw[["model"]][["par"]][["l"]],digits = 4)
b<-round(pib_hw[["model"]][["par"]][["b"]], digits = 4)
s0<-round(pib_hw[["model"]][["par"]][["s0"]], digits = 4)
s1<-round(pib_hw[["model"]][["par"]][["s1"]], digits = 4)
s2<-round(pib_hw[["model"]][["par"]][["s2"]], digits = 4)
s3<-round(pib_hw[["model"]][["par"]][["s3"]], digits = 4)
s4<-round(pib_hw[["model"]][["par"]][["s4"]], digits = 4)
s5<-round(pib_hw[["model"]][["par"]][["s5"]], digits = 4)
s6<-round(pib_hw[["model"]][["par"]][["s6"]], digits = 4)
s7<-round(pib_hw[["model"]][["par"]][["s7"]], digits = 4)
s8<-round(pib_hw[["model"]][["par"]][["s8"]], digits = 4)
s9<-round(pib_hw[["model"]][["par"]][["s9"]], digits = 4)
s10<-round(pib_hw[["model"]][["par"]][["s10"]], digits = 4)
estado_inic<-data.frame(c(l, b, s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10))
colnames(parametros)<-c("Estados Iniciais utilizados")
rownames(parametros)<-c("l", "b", "s0", "s1", "s2", "s3", "s4", "s5", "s6", "s7", "s8",
"s9", "s10")
View(estado_inic)
estado_inic<-data.frame(c(l, b, s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10))
colnames(estado_inic)<-c("Estados Iniciais utilizados")
rownames(estado_inic)<-c("l", "b", "s0", "s1", "s2", "s3", "s4", "s5", "s6", "s7", "s8",
"s9", "s10")
View(estado_inic)
loglik <- pib_hw[["model"]][["loglik"]]
aic <- pib_hw[["model"]][["aic"]]
bic <- pib_hw[["model"]][["bic"]]
aicc <- pib_hw[["model"]][["aicc"]]
mse <- pib_hw[["model"]][["mse"]]
amse <- pib_hw[["model"]][["amse"]]
s10<-round(pib_hw[["model"]][["par"]][["s10"]])
alpha<-round(pib_hw[["model"]][["par"]][["alpha"]], digits = 4)
beta<-round(pib_hw[["model"]][["par"]][["beta"]], digits = 4)
gamma<-round(pib_hw[["model"]][["par"]][["gamma"]], digits = 4)
sigma<-round(sqrt(pib_hw[["model"]][["sigma2"]]), digits = 4)
parametros<-data.frame(c(alpha, beta, gamma, sigma))
colnames(parametros)<-c("Parâmetros estimados")
rownames(parametros)<-c("alpha", "beta", "gamma", "sigma")
# Estados Iniciais
l<-round(pib_hw[["model"]][["par"]][["l"]])
b<-round(pib_hw[["model"]][["par"]][["b"]])
s0<-round(pib_hw[["model"]][["par"]][["s0"]])
s1<-round(pib_hw[["model"]][["par"]][["s1"]])
s2<-round(pib_hw[["model"]][["par"]][["s2"]])
s3<-round(pib_hw[["model"]][["par"]][["s3"]])
s4<-round(pib_hw[["model"]][["par"]][["s4"]])
s5<-round(pib_hw[["model"]][["par"]][["s5"]])
s6<-round(pib_hw[["model"]][["par"]][["s6"]])
s7<-round(pib_hw[["model"]][["par"]][["s7"]])
s8<-round(pib_hw[["model"]][["par"]][["s8"]])
s9<-round(pib_hw[["model"]][["par"]][["s9"]])
s10<-round(pib_hw[["model"]][["par"]][["s10"]])
estado_inic<-data.frame(c(l, b, s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10))
colnames(estado_inic)<-c("Estados Iniciais utilizados")
rownames(estado_inic)<-c("l", "b", "s0", "s1", "s2", "s3", "s4", "s5", "s6", "s7", "s8",
"s9", "s10")
inf_crit<-data.frame(c(loglik, aic, bic, aicc, mse, amse))
colnames(inf_crit)<-c("Critérios de Informação")
rownames(inf_crit)<-c("loglik", "aic", "bic", "aicc", "mse", "amse")
View(inf_crit)
inf_crit<-data.frame(c(loglik, aic, bic, aicc, mse, amse))
colnames(inf_crit)<-c("Critérios de Informação")
rownames(inf_crit)<-c("LogLik", "AIC", "BIC", "AICC", "MSE", "AMSE")
print(xtable(estado_inic, caption = "Estados Iniciais utilizados na Previsão do Modelo HW",
label = "tab2"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(inf_crit, caption = "Critérios de Informação do Modelo de HW",
label = "tab3"),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
print(xtable(estado_inic, caption = "Estados Iniciais utilizados na Previsão do Modelo HW",
label = "tab2", digits = 0),
caption.placement = "top",
include.rownames = TRUE,
format.args = list(big.mark = ".", decimal.mark = ","))
View(pib_prev)
View(pib_hw)
